import tkinter as tk
from datetime import datetime
import os

# Funkce pro na캜ten칤/ulo쬰n칤 jm칠na
def get_username():
    filename = "username.txt"
    if os.path.exists(filename):
        with open(filename, "r", encoding="utf-8") as f:
            name = f.read().strip()
            if name:
                return name
    return None

def save_username(name):
    with open("username.txt", "w", encoding="utf-8") as f:
        f.write(name.strip())

# Funkce pro pozdrav
def greet_user():
    name = get_username()
    if name:
        vystup.insert(tk.END, f"Bot: Ahoj {name}, r치d t캩 zase vid칤m! 游뗵\n")
    else:
        vystup.insert(tk.END, "Bot: Ahoj! Jak se jmenuje코?\n")

# Funkce pro odpov캩di
def odpovez():
    dotaz = vstup.get()
    vystup.insert(tk.END, "Ty: " + dotaz + "\n")

    # Pokud zat칤m nen칤 ulo쬰n칠 jm칠no, prvn칤 vstup bereme jako jm칠no
    name = get_username()
    if not name:
        save_username(dotaz)
        vystup.insert(tk.END, f"Bot: T캩코칤 m캩, {dotaz}! Budu si t캩 pamatovat. 游뗵\n")
        vstup.delete(0, tk.END)
        return

    responses = {
        "ahoj": f"Ahoj {name}! R치d t캩 vid칤m.",
        "jak se m치코": "M치m se dob콏e, d캩kuju!",
        "co d캩l치코": "Pov칤d치m si s tebou :)",
        "kup mi avok치do": "Jsem moc broke :(",
        "iss live": "https://isslivenow.com/",
        "na co se t캩 m콢쬿 zeptat ?" : "ahoj, jak se m치코, co d캩l치코, kup mi avok치do, iss live, update",
        "update" : "v dal코칤m update se bude코 moc pt치t na po캜as칤 a pozici iss"
    }

    odpoved = responses.get(dotaz.lower(), "Promi켿, tomu zat칤m nerozum칤m.")
    vystup.insert(tk.END, "Bot: " + odpoved + "\n")

    log.insert(tk.END, f"{datetime.now().strftime('%H:%M:%S')} - Dotaz: {dotaz}\n")
    log.insert(tk.END, f"{datetime.now().strftime('%H:%M:%S')} - Odpov캩캞: {odpoved}\n")
    vstup.delete(0, tk.END)

# Hlavn칤 okno
root = tk.Tk()
root.title("AI ChatBot")

# Vstupn칤 pole
vstup = tk.Entry(root, width=50)
vstup.pack(pady=10)

# Tla캜칤tko
tlacitko = tk.Button(root, text="Odeslat", command=odpovez)
tlacitko.pack()

# V칳stupn칤 pole
vystup = tk.Text(root, height=10, width=60)
vystup.pack(pady=10)

# Logovac칤 okno
log_okno = tk.Toplevel(root)
log_okno.title("Logy")
log = tk.Text(log_okno, height=15, width=50)
log.pack()

# Spu코t캩n칤 pozdravu
greet_user()

root.mainloop()

